_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[14],{"/wGY":function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n("VtrM"),o=function(){return fetch.apply(void 0,arguments).then((function(t){return t.json()}))};function c(t,e){var n=[],c=0,a=Object(r.a)("/api/books?limit=".concat(t,"&page=").concat(e),o,{refreshInterval:500}),i=a.data,s=a.error;return null!==i&&void 0!==i&&(n=i.data,c=i.count),{loading:!i&&!s,error:s,books:n,count:c}}},"20a2":function(t,e,n){t.exports=n("nOHt")},"HaE+":function(t,e,n){"use strict";function r(t,e,n,r,o,c,a){try{var i=t[c](a),s=i.value}catch(u){return void n(u)}i.done?e(s):Promise.resolve(s).then(r,o)}function o(t){return function(){var e=this,n=arguments;return new Promise((function(o,c){var a=t.apply(e,n);function i(t){r(a,o,c,i,s,"next",t)}function s(t){r(a,o,c,i,s,"throw",t)}i(void 0)}))}}n.d(e,"a",(function(){return o}))},Lekj:function(t,e,n){"use strict";var r=n("nKUr"),o=n("YFqc"),c=n.n(o);e.a=function(t){var e=t.curPage,n=t.itemsPerPage,o=t.totalItems,a=t.url,i="bg-black border-none px-5 py-2 text-xl text-white rounded mx-2 row-span-full";n=parseInt(n),o=parseInt(o),e=parseInt(e);var s=Object(r.jsx)(r.Fragment,{}),u=Object(r.jsx)(r.Fragment,{});if(Number.isInteger(n)&&Number.isInteger(e)&&Number.isInteger(o)&&n>0&&o>0&&e>0){var l=Math.ceil(o/n);e>1&&(s=Object(r.jsx)(c.a,{href:"".concat(a,"/?limit=").concat(n,"&page=").concat(e-1),children:Object(r.jsx)("a",{className:i+" justify-self-start",children:"<"})})),e<l&&(u=Object(r.jsx)(c.a,{href:"".concat(a,"/?limit=").concat(n,"&page=").concat(e+1),children:Object(r.jsx)("a",{className:i+" justify-self-end",children:">"})}))}return Object(r.jsxs)("div",{className:"grid mt-5",children:[s,u]})}},RNiq:function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return p}));var r=n("nKUr"),o=n("80PL"),c=n("LBrS"),a=n("ohB0"),i=function(t){var e=t.books;return null===e||void 0===e||e.length<1?Object(r.jsx)("div",{className:"text-center text-gray-800 mt-3 py-3 text-3xl bg-gray-300 bg-opacity-70",children:"Library is empty."}):Object(r.jsx)("div",{children:e.map((function(t){return Object(r.jsx)(a.a,{book:t,links:{checkout:!0,edit:!1,delete:!1}},"book-item-".concat(t.isbn))}))})},s=n("/wGY"),u=n("7r2f"),l=n("Lekj"),f=n("YFqc"),b=n.n(f),d=n("20a2");function p(){var t=Object(d.useRouter)().query,e=t.limit,n=t.page,a=parseInt(e),f=parseInt(n);(!Number.isInteger(a)||a<1)&&(a=10),(!Number.isInteger(f)||f<1)&&(f=1);var p=Object(s.a)(e,n),h=p.loading,j=p.error,x=p.books,m=p.count,g=Object(r.jsx)(r.Fragment,{});return g=j?Object(r.jsx)(u.a,{children:Object(r.jsx)("main",{className:"text-center mx-auto py-2 mb-2 text-2xl bg-gray-800 text-white bg-opacity-80 rounded-lg w-3/4",children:"Failed to load -_-"})}):h?Object(r.jsx)(u.a,{children:Object(r.jsx)("main",{className:"text-center mx-auto py-2 mb-2 text-2xl bg-gray-800 text-white bg-opacity-80 rounded-lg w-3/4",children:"Loading..."})}):Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)("div",{className:"flex flex-col justify-between text-center",children:[Object(r.jsxs)("p",{className:"mx-auto py-2 mb-2 text-2xl bg-gray-800 text-white bg-opacity-80 rounded-lg w-full",children:["Book count:"," ",Object(r.jsx)("span",{className:"font-bold text-green-500",children:m})]}),Object(r.jsx)(b.a,{href:"/books/new",children:Object(r.jsx)("a",{className:" bg-gray-200 text-green text-base font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-green-300 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 focus:ring-offset-green-200",children:"+ Create"})})]}),Object(r.jsx)(l.a,{itemsPerPage:a,totalItems:m,curPage:f,url:"http://localhost:3000"}),Object(r.jsx)(i,{books:x}),Object(r.jsx)(l.a,{itemsPerPage:a,totalItems:m,curPage:f,url:"http://localhost:3000"})]}),Object(r.jsxs)(o.a,{children:[Object(r.jsx)(c.a,{text:"Welcome to the Library"}),Object(r.jsx)(u.a,{children:g})]})}},ohB0:function(t,e,n){"use strict";var r=n("nKUr"),o=n("o0o1"),c=n.n(o),a=n("HaE+");function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){return(l="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t,e){return!e||"object"!==l(e)&&"function"!==typeof e?s(t):e}function b(t){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var d=n("q1tI"),p=n.n(d),h=n("wyBh");function j(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=b(t);if(e){var o=b(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return f(this,n)}}var x=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(f,t);var e,n,o,l=j(f);function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(e=l.call(this,t)).state={available:e.props.available,bookId:e.props.bookId},e.handleClick=e.handleClick.bind(s(e)),e}return e=f,(n=[{key:"handleClick",value:function(){var t=Object(a.a)(c.a.mark((function t(e){var n,r=this;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.preventDefault(),n=this.state.available?h.f:h.e,fetch("/api/books/setState/".concat(this.props.bookId,"?state=").concat(n)).then((function(t){400==t.status?alert("Sorry, the book's status is already ".concat(n)):404==t.status?alert("That book could not be found."):r.setState({available:!r.state.available})}));case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(t){this.props.available!==t.available&&this.setState({available:this.props.available})}},{key:"render",value:function(){return this.state.available?Object(r.jsx)("a",{onClick:this.handleClick,className:"px-2 py-1 bg-yellow-600 text-white font-bold rounded cursor-pointer",children:"Check Out"}):Object(r.jsx)("a",{onClick:this.handleClick,className:"px-2 py-1 bg-green-500 text-white font-bold rounded cursor-pointer",children:"Return"})}}])&&i(e.prototype,n),o&&i(e,o),f}(p.a.Component),m=n("7r2f"),g=n("YFqc"),y=n.n(g),v=function(){var t=Object(a.a)(c.a.mark((function t(e,n){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=3;break}return alert("Book ID not found"),t.abrupt("return");case 3:fetch("/api/books/".concat(e),{method:"DELETE"}).then((function(t){return t.json()})).then((function(t){console.log(t),t.success?(alert("Deleted successfully!"),n()):alert(t.message)})).catch((function(t){alert("Error:",t),console.log(t)}));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),O=n("20a2");e.a=function(t){var e=t.book,n=t.links,o=void 0===n?{checkout:!0,edit:!0,delete:!0}:n,c=Object(O.useRouter)();return Object(r.jsx)(m.a,{children:Object(r.jsxs)("div",{className:"mt-6 mx-auto max-w-4xl px-10 py-6 bg-white rounded-lg shadow-md",children:[Object(r.jsx)(y.a,{href:"".concat("http://localhost:3000","/books/").concat(e._id),children:Object(r.jsx)("a",{className:"text-2xl text-gray-700 font-bold hover:underline",children:e.title})}),Object(r.jsx)("p",{className:"mt-2 text-gray-600",children:e.author}),Object(r.jsx)("p",{className:"mt-2 text-gray-600 italic",children:e.description}),Object(r.jsxs)("p",{className:"mt-4 text-gray-400",children:["ISBN: ",e.isbn]}),Object(r.jsxs)("div",{className:"mt-4 flex space-x-2",children:[o.checkout?Object(r.jsx)(x,{bookId:e._id,available:"AVAILABLE"==e.state}):Object(r.jsx)(r.Fragment,{}),o.edit?Object(r.jsx)(y.a,{href:"/books/".concat(e._id,"/edit"),children:Object(r.jsx)("a",{className:"px-2 py-1 bg-gray-300 font-bold rounded cursor-pointer",children:"Edit"})}):Object(r.jsx)(r.Fragment,{}),o.delete?Object(r.jsx)("a",{onClick:function(){return v(e._id,(function(){c.push("/")}))},className:"px-2 py-1 bg-gray-300 text-red-500 font-bold rounded cursor-pointer",children:"X"}):Object(r.jsx)(r.Fragment,{})]})]})})}},vlRD:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n("RNiq")}])},wyBh:function(t,e,n){"use strict";n.d(e,"f",(function(){return r})),n.d(e,"e",(function(){return o})),n.d(e,"g",(function(){return c})),n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i})),n.d(e,"d",(function(){return s})),n.d(e,"c",(function(){return u}));var r="CHECKED_OUT",o="AVAILABLE",c=150,a=150,i=2e3,s=1e12,u=9999999999999}},[["vlRD",0,2,3,1,4,5]]]);