_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[11],{"+Yye":function(t,e,n){"use strict";var r=n("nKUr"),c=function(t){if(null==t&&void 0==t)return"";try{var e=new Date(t);return new Intl.DateTimeFormat("default",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!1}).format(e)}catch(n){return""}},o=function(t){var e=t.book,n=t.cols,o="px-5 py-5 border-b border-gray-200 bg-yellow-50 text-sm";return Object(r.jsxs)("tr",{children:[n.title?Object(r.jsx)("td",{className:o,children:e.title}):Object(r.jsx)(r.Fragment,{}),n.author?Object(r.jsx)("td",{className:o,children:e.author}):Object(r.jsx)(r.Fragment,{}),n.description?Object(r.jsx)("td",{className:o,children:e.description}):Object(r.jsx)(r.Fragment,{}),n.isbn?Object(r.jsx)("td",{className:o,children:e.isbn}):Object(r.jsx)(r.Fragment,{}),n.state?Object(r.jsx)("td",{className:o,children:e.state}):Object(r.jsx)(r.Fragment,{}),n.historyState?Object(r.jsx)("td",{className:o,children:e.history.state}):Object(r.jsx)(r.Fragment,{}),n.historyDate?Object(r.jsx)("td",{className:o,children:c(e.history.actionDate)}):Object(r.jsx)(r.Fragment,{})]})};e.a=function(t){var e=t.books,n=t.emptyMessage,c=t.cols,a="px-5 py-3 border-b-2 border-gray-200 bg-gray-800 text-left text-xs font-semibold text-white uppercase tracking-wider";return null===e||void 0===e||e.length<1?Object(r.jsx)("div",{className:" text-center rounded text-gray-800 mt-3 p-3 text-2xl bg-gray-300 bg-opacity-70",children:n}):Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("p",{className:"text-center text-white my-3 md:hidden",children:"\u2190 Scroll \u2192"}),Object(r.jsx)("div",{className:"-mx-4 sm:-mx-8 px-4 sm:px-8 py-4 overflow-x-auto",children:Object(r.jsxs)("table",{className:"min-w-full leading-normal",children:[Object(r.jsx)("thead",{children:Object(r.jsxs)("tr",{children:[c.title?Object(r.jsx)("th",{className:a,children:"Title"}):Object(r.jsx)(r.Fragment,{}),c.author?Object(r.jsx)("th",{className:a,children:"Author"}):Object(r.jsx)(r.Fragment,{}),c.description?Object(r.jsx)("th",{className:a,children:"Description"}):Object(r.jsx)(r.Fragment,{}),c.isbn?Object(r.jsx)("th",{className:a,children:"ISBN"}):Object(r.jsx)(r.Fragment,{}),c.state?Object(r.jsx)("th",{className:a,children:"Status"}):Object(r.jsx)(r.Fragment,{}),c.historyState?Object(r.jsx)("th",{className:a,children:"State"}):Object(r.jsx)(r.Fragment,{}),c.historyDate?Object(r.jsx)("th",{className:a,children:"Date"}):Object(r.jsx)(r.Fragment,{})]})}),Object(r.jsx)("tbody",{className:"text-sm font-normal text-gray-700",children:e.map((function(t,e){return Object(r.jsx)(o,{book:t,cols:c},"book-item-".concat(t.isbn,"-").concat(e))}))})]})})]})}},"20a2":function(t,e,n){t.exports=n("nOHt")},ES7X:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/books/[id]",function(){return n("etG2")}])},"HaE+":function(t,e,n){"use strict";function r(t,e,n,r,c,o,a){try{var s=t[o](a),i=s.value}catch(l){return void n(l)}s.done?e(i):Promise.resolve(i).then(r,c)}function c(t){return function(){var e=this,n=arguments;return new Promise((function(c,o){var a=t.apply(e,n);function s(t){r(a,c,o,s,i,"next",t)}function i(t){r(a,c,o,s,i,"throw",t)}s(void 0)}))}}n.d(e,"a",(function(){return c}))},etG2:function(t,e,n){"use strict";n.r(e);var r=n("o0o1"),c=n.n(r),o=n("HaE+"),a=n("nKUr"),s=n("80PL"),i=n("LBrS"),l=n("ohB0"),u=n("+Yye"),b=n("7r2f"),d=function(t){var e=t.book,n=Object(a.jsx)(a.Fragment,{});if(e&&void 0!==e){var r=e.history.map((function(t){return{history:{state:t.state,actionDate:t.actionDate}}}));n=Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(l.a,{book:e,links:{checkout:!1,edit:!0,delete:!0}}),Object(a.jsx)("br",{}),Object(a.jsx)(i.a,{text:"History"}),null!==r&&void 0!==r&&r.length?Object(a.jsx)(u.a,{books:r,cols:{title:!1,author:!1,description:!1,isbn:!1,historyState:!0,historyDate:!0}}):Object(a.jsx)("p",{className:"text-center mx-auto py-2 mb-2 text-2xl bg-gray-800 text-white bg-opacity-80 rounded-lg w-3/4",children:"No history for this book."})]})}else n=Object(a.jsx)("p",{className:"text-center mx-auto py-2 mb-2 text-2xl bg-gray-800 text-white bg-opacity-80 rounded-lg w-3/4",children:"Couldn't find that book."});return Object(a.jsx)(a.Fragment,{children:Object(a.jsxs)(s.a,{children:[Object(a.jsx)(i.a,{text:"View Book"}),Object(a.jsx)(b.a,{children:n})]})})};d.getInitialProps=function(){var t=Object(o.a)(c.a.mark((function t(e){var n,r,o,a;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.query.id,t.next=3,fetch("".concat("http://localhost:3000","/api/books/").concat(n));case 3:return r=t.sent,t.next=6,r.json();case 6:return o=t.sent,a=o.data,t.abrupt("return",{book:a});case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.default=d},ohB0:function(t,e,n){"use strict";var r=n("nKUr"),c=n("o0o1"),o=n.n(c),a=n("HaE+");function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){return(u="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function b(t,e){return!e||"object"!==u(e)&&"function"!==typeof e?i(t):e}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=n("q1tI"),j=n.n(h),f=n("wyBh");function x(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d(t);if(e){var c=d(this).constructor;n=Reflect.construct(r,arguments,c)}else n=r.apply(this,arguments);return b(this,n)}}var p=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(b,t);var e,n,c,u=x(b);function b(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,b),(e=u.call(this,t)).state={available:e.props.available,bookId:e.props.bookId},e.handleClick=e.handleClick.bind(i(e)),e}return e=b,(n=[{key:"handleClick",value:function(){var t=Object(a.a)(o.a.mark((function t(e){var n,r=this;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.preventDefault(),n=this.state.available?f.f:f.e,fetch("/api/books/setState/".concat(this.props.bookId,"?state=").concat(n)).then((function(t){400==t.status?alert("Sorry, the book's status is already ".concat(n)):404==t.status?alert("That book could not be found."):r.setState({available:!r.state.available})}));case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(t){this.props.available!==t.available&&this.setState({available:this.props.available})}},{key:"render",value:function(){return this.state.available?Object(r.jsx)("a",{onClick:this.handleClick,className:"px-2 py-1 bg-yellow-600 text-white font-bold rounded cursor-pointer",children:"Check Out"}):Object(r.jsx)("a",{onClick:this.handleClick,className:"px-2 py-1 bg-green-500 text-white font-bold rounded cursor-pointer",children:"Return"})}}])&&s(e.prototype,n),c&&s(e,c),b}(j.a.Component),m=n("7r2f"),y=n("YFqc"),O=n.n(y),g=function(){var t=Object(a.a)(o.a.mark((function t(e,n){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=3;break}return alert("Book ID not found"),t.abrupt("return");case 3:fetch("/api/books/".concat(e),{method:"DELETE"}).then((function(t){return t.json()})).then((function(t){console.log(t),t.success?(alert("Deleted successfully!"),n()):alert(t.message)})).catch((function(t){alert("Error:",t),console.log(t)}));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),v=n("20a2");e.a=function(t){var e=t.book,n=t.links,c=void 0===n?{checkout:!0,edit:!0,delete:!0}:n,o=Object(v.useRouter)();return Object(r.jsx)(m.a,{children:Object(r.jsxs)("div",{className:"mt-6 mx-auto max-w-4xl px-10 py-6 bg-white rounded-lg shadow-md",children:[Object(r.jsx)(O.a,{href:"".concat("http://localhost:3000","/books/").concat(e._id),children:Object(r.jsx)("a",{className:"text-2xl text-gray-700 font-bold hover:underline",children:e.title})}),Object(r.jsx)("p",{className:"mt-2 text-gray-600",children:e.author}),Object(r.jsx)("p",{className:"mt-2 text-gray-600 italic",children:e.description}),Object(r.jsxs)("p",{className:"mt-4 text-gray-400",children:["ISBN: ",e.isbn]}),Object(r.jsxs)("div",{className:"mt-4 flex space-x-2",children:[c.checkout?Object(r.jsx)(p,{bookId:e._id,available:"AVAILABLE"==e.state}):Object(r.jsx)(r.Fragment,{}),c.edit?Object(r.jsx)(O.a,{href:"/books/".concat(e._id,"/edit"),children:Object(r.jsx)("a",{className:"px-2 py-1 bg-gray-300 font-bold rounded cursor-pointer",children:"Edit"})}):Object(r.jsx)(r.Fragment,{}),c.delete?Object(r.jsx)("a",{onClick:function(){return g(e._id,(function(){o.push("/")}))},className:"px-2 py-1 bg-gray-300 text-red-500 font-bold rounded cursor-pointer",children:"X"}):Object(r.jsx)(r.Fragment,{})]})]})})}},wyBh:function(t,e,n){"use strict";n.d(e,"f",(function(){return r})),n.d(e,"e",(function(){return c})),n.d(e,"g",(function(){return o})),n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return s})),n.d(e,"d",(function(){return i})),n.d(e,"c",(function(){return l}));var r="CHECKED_OUT",c="AVAILABLE",o=150,a=150,s=2e3,i=1e12,l=9999999999999}},[["ES7X",0,2,3,1,4]]]);